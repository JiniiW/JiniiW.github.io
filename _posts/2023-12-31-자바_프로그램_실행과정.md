---
title: "[JAVA] 자바 프로그램의 실행과정"
excerpt: "Compile, Runtime, loading"

categories:
  - Java
tags:
  - [Compile, JVM, Runtime, loaidng, memory]

permalink: /java/2023-12-31-자바_프로그램_실행과정/

toc: true
toc_sticky: true

date: 2023-12-31
last_modified_at: 2023-12-31
---
## Intro
JVM의 메모리 구조에 대해 공부하며 프로그램의 실행 과정이 크게 컴파일 과정과 런타임 과정으로 나뉘게 되는것을 깨달았다.

자바 프로그램의 실행과정에 대해 더 확실히 이해하기 위해 이 과정이 어떻게 나눠지는지를 알아볼 것이다.

또한 흔히 '프로그램이 로딩되면'이라는 말을 많이 사용하는데 여기서 로딩은 정확히 어떤 시점에 발생하는지 같이 살펴보자.

---

먼저 자바 프로그램의 실행 과정을 알기 위해서는 JVM의 구동방식을 먼저 파악해야 한다.

## JVM 구동방식

>소스 코드(.java) -> 컴파일(.class) -> 로딩 -> 런타임 환경 설정 -> 프로그램 실행  -> 런타임

JVM의 구동 방식을 정말 간단하게 살펴보면 다음과 같은 순서로 나눌 수 있다.

1. 소스코드(.java) : 개발자가 작성한 소스코드로 시작한다.
2. 컴파일(Compile) : 자바 소스코드가 컴파일러에 의해 바이트 코드(.class)파일로 변환하는 과정이다.
3. 로딩(Loading) : 해석된 바이트 코드를 메모리에 적재한다.
4. 런타임 환경 설정 : 메모리에 로딩된 바이트 코드는 런타임 환경을 설정한다.
5. 프로그램 실행 : 프로그램이 실행되면서 동적으로 메모리를 할당하고 코드를 실행한다.
  - 이 때, JIT 컴파일러가 변환된 바이트 코드를 OS에 맞는 네이티브 코드로 변환한다.
6. 런타임(Runtime) : 실행중인 프로그램은 런타임 환경에서 작동한다.


그러면 제일 많이 언급되는 컴파일, 로딩, 런타임에 대해 세부적으로 알아보자.

### 컴파일(Compile)
먼저 컴파일이다.

>컴파일은 소스코드를 바이트 코드로 변환하는 과정을 의미한다.

우리 작성한 자바 파일은 JVM에서 실행할 수 있는 바이트 코드 파일로 변환하는 과정 자체를 컴파일이라 하는 것이다.

이때 `javac` 명령어를 통해 컴파일을 진행한다.

프로그램 확장자명으로 순서를 나타내면 다음과 같다.

> .java -> javac -> .class [자바 소스코드 -> 바이트 코드]

### 로딩(Loading)
다음은 로딩이다.

> 로딩은 컴파일에서 해석된 바이트 코드를 메모리에 적재하는 과정이다.

바이트 코드나 실행에 필요한 데이터를 불러오기 위해 JVM의 메모리에 클래스 파일의 정보를 먼저 저장하는 과정이다.

평소 말하는 "프로그램이 로딩되면"이란 문장의 뜻은 프로그램에 필요한 데이터와 코드가 **컴퓨터의 메모리에 올려져서 실행할 수 있는 상태**가 되었다 의미인 것이다.

결론적으로 해당 프로그램이 메모리에 로드되어 실행 중비가 된 상태를 나타낸다.

### 런타임(Runtime)
마지막으로 런타임이다.

> 런타임은 프로그램이 실행되는 동안을 말한다.

프로그램이 로딩되어 메모리에 올라간 후 부터 종료될 때까지의 과정을 의미한다.

이 과정에서는 프로그램이 동적으로 메모리를 할당하고 코드를 실행하며 JIT 컴파일러가 바이트 코드를 해당 OS에 맞는 네이티브 코드로 변환 성능을 최적화 시킨다.

결론적으로 런타임은 실제 프로그램이 동작하고 있는 시간동의 환경인것이다.

> Byte 코드 -> JIT Compiler ->  Native 코드

<br>
지금까지의 과정을 간단하게 말하면 자바 소스코드가 바이트 코드로 변환되고 또 네이티브 코드로 변환되는 과정인데, 왜 이렇게 코드를 계속 변환하는 것일까? 갑자기 궁금해졌다.

그 이유는 바로 자바라는 언어의 특징 때문이다.

## 코드의 최적화
자바 언어의 특징하면 바로 다음과 같이 나온다.
> 플랫폼에 독립적, 이식성, 최적화등

이러한 특징이 가능한 이유는 아래의 사진을 보면 알 수 있다.

<img src = "{{url}}/images/2023-12-31-Java_Program_Run/JVM_OS.png" width="50%">

자바는 다른 언어와 다르게 OS와 프로그램 사이에 JVM이 존재하기 때문에 OS에 독립적이면서 플랫폼간의 호환성을 제공할 수 있는 것이다.

즉, 자바 언어로 작성한 코드는 어느 운영체제와 상관없이 실행이 가능하다는 말이다. 

**OS의 최적화**도 가능하다. 초기에는 바이트코드 자체를 바로 해석하여 실행했지만 성능 향상을 위해 JIT 컴파일러가 도입었다. JIT 컴파일러가 프로그램이 실행하는 도중에 각각의 OS의 네이티브 코드로 변환하는 역할을 가진다.<br> 
때문에 각 운영체제에 특화된 최적화를 통해 프로그램의 성능이 향상된다고 말할 수 있다.

>결론적으로 자바 프로그램을 실행할 때 **프로그램 -> JVM -> OS**까지의 과정을 진행하기 때문에 코드의 변환과 최적화가 발생하는 것이다.

## 결론

지금까지 작성한 내용을 아래의 그림 한장으로 정리할 수 있다.

<img src = "{{url}}/images/2023-12-31-Java_Program_Run/자바_프로그램_최종.png" width="90%">

---

## Outro

이 글을 작성하면서 JVM의 메모리 구조와 자바 프로그램 실행 과정에 대해 깊이 이해할 수 있었다. 

특히, 컴파일, 로딩, 런타임 과정이 어떻게 나눠지고 각각이 어떤 역할을 하는지에 대한 설명을 통해 평소 모해했던 개념을 명확히 짚고 넘어갈 수 있어서 좋았다.

또한, 반복되는 코드 변환에 대한 궁금증을 해결하고자 자바의 특징 중 하나인 플랫폼 독립성과 최적화에 대한 내용도 다루면서 자바 언어의 강점을 다시 한번 인지할 수 있게 되었다.

이를 통해 자바 프로그램이 어떻게 실행되는지에 대한 이해가 높아져, 향후 자바 언어를 사용할 때 더 효과적으로 코드를 작성하고 최적화할 수 있을 것 같다.

프로그램의 실행 과정을 파악하는 것이 전체적인 프로그램 개발에 도움이 될 것이며, 이를 통해 더 나은 개발자로 성장하고 싶다.